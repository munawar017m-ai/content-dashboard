{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sumee/OneDrive/Desktop/content-generation/app/workspace/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\n\r\n/* ----------------------------------------------\r\n   TYPES\r\n---------------------------------------------- */\r\ntype ContentIdea = {\r\n  title?: string;\r\n  hook?: string;\r\n  script?: string;\r\n  caption?: string;\r\n  hashtags?: string[];\r\n  cta?: string;\r\n  explanation?: string;\r\n  [k: string]: any;\r\n};\r\n\r\ntype ChatMessage = {\r\n  sender: \"user\" | \"ai\";\r\n  text: string;\r\n  ideas?: ContentIdea[];\r\n};\r\n\r\n/* ----------------------------------------------\r\n   MAIN WORKSPACE COMPONENT\r\n---------------------------------------------- */\r\nexport default function Workspace() {\r\n  const [messages, setMessages] = useState<ChatMessage[]>([\r\n    { sender: \"ai\", text: \"Hey! ðŸ‘‹ What content do you want to create today?\" },\r\n  ]);\r\n\r\n  const [input, setInput] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const scrollRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  /* ----------------------------------------------\r\n     Auto scroll\r\n  ---------------------------------------------- */\r\n  useEffect(() => {\r\n    const el = scrollRef.current;\r\n    if (el) el.scrollTop = el.scrollHeight;\r\n  }, [messages]);\r\n\r\n  /* ----------------------------------------------\r\n     SEND MESSAGE\r\n  ---------------------------------------------- */\r\n  const sendMessage = async () => {\r\n    if (!input.trim()) return;\r\n\r\n    const text = input.trim();\r\n    setInput(\"\");\r\n\r\n    const userMsg: ChatMessage = { sender: \"user\", text };\r\n    setMessages((prev) => [...prev, userMsg]);\r\n\r\n    const payloadMessages = [\r\n      ...messages.map((m) => ({\r\n        role: m.sender === \"user\" ? \"user\" : \"assistant\",\r\n        content: m.text,\r\n      })),\r\n      { role: \"user\", content: text },\r\n    ];\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/chat\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ messages: payloadMessages }),\r\n      });\r\n\r\n      const json = await res.json();\r\n      const reply = json.reply;\r\n\r\n      let aiText = \"\";\r\n      let ideaArray: ContentIdea[] | undefined;\r\n\r\n      if (reply) {\r\n        const c = reply.content;\r\n\r\n        if (typeof c === \"string\") {\r\n          try {\r\n            const parsed = JSON.parse(c);\r\n            if (Array.isArray(parsed)) {\r\n              ideaArray = parsed;\r\n              aiText = `Generated ${parsed.length} content ideas.`;\r\n            } else {\r\n              aiText = c;\r\n            }\r\n          } catch {\r\n            aiText = c;\r\n          }\r\n        }\r\n      }\r\n\r\n      const aiMessage: ChatMessage = { sender: \"ai\", text: aiText };\r\n      if (ideaArray) aiMessage.ideas = ideaArray;\r\n\r\n      setMessages((prev) => [...prev, aiMessage]);\r\n    } catch {\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        { sender: \"ai\", text: \"Something went wrong â€” try again.\" },\r\n      ]);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const onEnter = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === \"Enter\") {\r\n      e.preventDefault();\r\n      sendMessage();\r\n    }\r\n  };\r\n\r\n  /* ----------------------------------------------\r\n     APPROVE / REJECT (Saves ONLY to localStorage)\r\n  ---------------------------------------------- */\r\n  const approve = (idea: ContentIdea) => {\r\n    try {\r\n      const raw = localStorage.getItem(\"cg_library_v1\");\r\n      const prev = raw ? JSON.parse(raw) : [];\r\n      const updated = [idea, ...prev];\r\n      localStorage.setItem(\"cg_library_v1\", JSON.stringify(updated));\r\n    } catch {}\r\n\r\n    setMessages((prev) => [\r\n      ...prev,\r\n      { sender: \"ai\", text: `Saved \"${idea.title ?? \"Untitled\"}\" to library.` },\r\n    ]);\r\n  };\r\n\r\n  const reject = (idea: ContentIdea) => {\r\n    setMessages((prev) => [\r\n      ...prev,\r\n      { sender: \"ai\", text: `Skipped \"${idea.title ?? \"Untitled\"}\".` },\r\n    ]);\r\n  };\r\n\r\n  /* ----------------------------------------------\r\n     IDEA TABS\r\n  ---------------------------------------------- */\r\n  const IdeaTabs = ({ ideas }: { ideas: ContentIdea[] }) => {\r\n    const [open, setOpen] = useState<number | null>(null);\r\n\r\n    return (\r\n      <div style={{ marginTop: 12, display: \"flex\", flexDirection: \"column\", gap: 12 }}>\r\n        {ideas.map((idea, idx) => {\r\n          const expanded = open === idx;\r\n\r\n          return (\r\n            <div\r\n              key={idx}\r\n              style={{\r\n                padding: 14,\r\n                borderRadius: 8,\r\n                background: \"#ffffff\",\r\n                border: \"1px solid #d6d9df\",\r\n                cursor: \"pointer\",\r\n              }}\r\n              onClick={() => setOpen(expanded ? null : idx)}\r\n            >\r\n              <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\r\n                <strong>{idea.title ?? `Content Idea ${idx + 1}`}</strong>\r\n                <span>{expanded ? \"â–²\" : \"â–¼\"}</span>\r\n              </div>\r\n\r\n              {expanded && (\r\n                <div style={{ marginTop: 10 }}>\r\n                  {idea.hook && <p><strong>Hook:</strong> {idea.hook}</p>}\r\n                  {idea.caption && <p><strong>Caption:</strong> {idea.caption}</p>}\r\n                  {idea.cta && <p><strong>CTA:</strong> {idea.cta}</p>}\r\n\r\n                  <div style={{ display: \"flex\", gap: 10, marginTop: 10 }}>\r\n                    <button onClick={() => approve(idea)}>Approve</button>\r\n                    <button onClick={() => reject(idea)}>Reject</button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  /* ----------------------------------------------\r\n     RENDER\r\n  ---------------------------------------------- */\r\n  return (\r\n    <div>\r\n      <div ref={scrollRef} style={{ height: \"80vh\", overflowY: \"auto\" }}>\r\n        {messages.map((m, i) => (\r\n          <div key={i} style={{ marginBottom: 12 }}>\r\n            <div>\r\n              <strong>{m.sender === \"ai\" ? \"AI:\" : \"You:\"}</strong> {m.text}\r\n            </div>\r\n\r\n            {m.sender === \"ai\" && m.ideas && <IdeaTabs ideas={m.ideas} />}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div style={{ display: \"flex\", gap: 8 }}>\r\n        <input\r\n          value={input}\r\n          onChange={(e) => setInput(e.target.value)}\r\n          onKeyDown={onEnter}\r\n          placeholder=\"Type your message...\"\r\n        />\r\n        <button onClick={sendMessage} disabled={loading}>\r\n          {loading ? \"...\" : \"Send\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AA2Be,SAAS;;;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAgB;QACtD;YAAE,QAAQ;YAAM,MAAM;QAAoD;KAC3E;IAED,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,YAAY,IAAA,uKAAM,EAAwB;IAEhD;;iDAE+C,GAC/C,IAAA,0KAAS;+BAAC;YACR,MAAM,KAAK,UAAU,OAAO;YAC5B,IAAI,IAAI,GAAG,SAAS,GAAG,GAAG,YAAY;QACxC;8BAAG;QAAC;KAAS;IAEb;;iDAE+C,GAC/C,MAAM,cAAc;QAClB,IAAI,CAAC,MAAM,IAAI,IAAI;QAEnB,MAAM,OAAO,MAAM,IAAI;QACvB,SAAS;QAET,MAAM,UAAuB;YAAE,QAAQ;YAAQ;QAAK;QACpD,YAAY,CAAC,OAAS;mBAAI;gBAAM;aAAQ;QAExC,MAAM,kBAAkB;eACnB,SAAS,GAAG,CAAC,CAAC,IAAM,CAAC;oBACtB,MAAM,EAAE,MAAM,KAAK,SAAS,SAAS;oBACrC,SAAS,EAAE,IAAI;gBACjB,CAAC;YACD;gBAAE,MAAM;gBAAQ,SAAS;YAAK;SAC/B;QAED,WAAW;QAEX,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,aAAa;gBACnC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,UAAU;gBAAgB;YACnD;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,QAAQ,KAAK,KAAK;YAExB,IAAI,SAAS;YACb,IAAI;YAEJ,IAAI,OAAO;gBACT,MAAM,IAAI,MAAM,OAAO;gBAEvB,IAAI,OAAO,MAAM,UAAU;oBACzB,IAAI;wBACF,MAAM,SAAS,KAAK,KAAK,CAAC;wBAC1B,IAAI,MAAM,OAAO,CAAC,SAAS;4BACzB,YAAY;4BACZ,SAAS,CAAC,UAAU,EAAE,OAAO,MAAM,CAAC,eAAe,CAAC;wBACtD,OAAO;4BACL,SAAS;wBACX;oBACF,EAAE,OAAM;wBACN,SAAS;oBACX;gBACF;YACF;YAEA,MAAM,YAAyB;gBAAE,QAAQ;gBAAM,MAAM;YAAO;YAC5D,IAAI,WAAW,UAAU,KAAK,GAAG;YAEjC,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAU;QAC5C,EAAE,OAAM;YACN,YAAY,CAAC,OAAS;uBACjB;oBACH;wBAAE,QAAQ;wBAAM,MAAM;oBAAoC;iBAC3D;QACH;QAEA,WAAW;IACb;IAEA,MAAM,UAAU,CAAC;QACf,IAAI,EAAE,GAAG,KAAK,SAAS;YACrB,EAAE,cAAc;YAChB;QACF;IACF;IAEA;;iDAE+C,GAC/C,MAAM,UAAU,CAAC;QACf,IAAI;YACF,MAAM,MAAM,aAAa,OAAO,CAAC;YACjC,MAAM,OAAO,MAAM,KAAK,KAAK,CAAC,OAAO,EAAE;YACvC,MAAM,UAAU;gBAAC;mBAAS;aAAK;YAC/B,aAAa,OAAO,CAAC,iBAAiB,KAAK,SAAS,CAAC;QACvD,EAAE,OAAM,CAAC;QAET,YAAY,CAAC,OAAS;mBACjB;gBACH;oBAAE,QAAQ;oBAAM,MAAM,CAAC,OAAO,EAAE,KAAK,KAAK,IAAI,WAAW,aAAa,CAAC;gBAAC;aACzE;IACH;IAEA,MAAM,SAAS,CAAC;QACd,YAAY,CAAC,OAAS;mBACjB;gBACH;oBAAE,QAAQ;oBAAM,MAAM,CAAC,SAAS,EAAE,KAAK,KAAK,IAAI,WAAW,EAAE,CAAC;gBAAC;aAChE;IACH;IAEA;;iDAE+C,GAC/C,MAAM,WAAW,CAAC,EAAE,KAAK,EAA4B;;QACnD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAgB;QAEhD,qBACE,6LAAC;YAAI,OAAO;gBAAE,WAAW;gBAAI,SAAS;gBAAQ,eAAe;gBAAU,KAAK;YAAG;sBAC5E,MAAM,GAAG,CAAC,CAAC,MAAM;gBAChB,MAAM,WAAW,SAAS;gBAE1B,qBACE,6LAAC;oBAEC,OAAO;wBACL,SAAS;wBACT,cAAc;wBACd,YAAY;wBACZ,QAAQ;wBACR,QAAQ;oBACV;oBACA,SAAS,IAAM,QAAQ,WAAW,OAAO;;sCAEzC,6LAAC;4BAAI,OAAO;gCAAE,SAAS;gCAAQ,gBAAgB;4BAAgB;;8CAC7D,6LAAC;8CAAQ,KAAK,KAAK,IAAI,CAAC,aAAa,EAAE,MAAM,GAAG;;;;;;8CAChD,6LAAC;8CAAM,WAAW,MAAM;;;;;;;;;;;;wBAGzB,0BACC,6LAAC;4BAAI,OAAO;gCAAE,WAAW;4BAAG;;gCACzB,KAAK,IAAI,kBAAI,6LAAC;;sDAAE,6LAAC;sDAAO;;;;;;wCAAc;wCAAE,KAAK,IAAI;;;;;;;gCACjD,KAAK,OAAO,kBAAI,6LAAC;;sDAAE,6LAAC;sDAAO;;;;;;wCAAiB;wCAAE,KAAK,OAAO;;;;;;;gCAC1D,KAAK,GAAG,kBAAI,6LAAC;;sDAAE,6LAAC;sDAAO;;;;;;wCAAa;wCAAE,KAAK,GAAG;;;;;;;8CAE/C,6LAAC;oCAAI,OAAO;wCAAE,SAAS;wCAAQ,KAAK;wCAAI,WAAW;oCAAG;;sDACpD,6LAAC;4CAAO,SAAS,IAAM,QAAQ;sDAAO;;;;;;sDACtC,6LAAC;4CAAO,SAAS,IAAM,OAAO;sDAAO;;;;;;;;;;;;;;;;;;;mBAvBtC;;;;;YA6BX;;;;;;IAGN;QA1CM;IA4CN;;iDAE+C,GAC/C,qBACE,6LAAC;;0BACC,6LAAC;gBAAI,KAAK;gBAAW,OAAO;oBAAE,QAAQ;oBAAQ,WAAW;gBAAO;0BAC7D,SAAS,GAAG,CAAC,CAAC,GAAG,kBAChB,6LAAC;wBAAY,OAAO;4BAAE,cAAc;wBAAG;;0CACrC,6LAAC;;kDACC,6LAAC;kDAAQ,EAAE,MAAM,KAAK,OAAO,QAAQ;;;;;;oCAAgB;oCAAE,EAAE,IAAI;;;;;;;4BAG9D,EAAE,MAAM,KAAK,QAAQ,EAAE,KAAK,kBAAI,6LAAC;gCAAS,OAAO,EAAE,KAAK;;;;;;;uBALjD;;;;;;;;;;0BAUd,6LAAC;gBAAI,OAAO;oBAAE,SAAS;oBAAQ,KAAK;gBAAE;;kCACpC,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wBACxC,WAAW;wBACX,aAAY;;;;;;kCAEd,6LAAC;wBAAO,SAAS;wBAAa,UAAU;kCACrC,UAAU,QAAQ;;;;;;;;;;;;;;;;;;AAK7B;GAjMwB;KAAA"}}]
}