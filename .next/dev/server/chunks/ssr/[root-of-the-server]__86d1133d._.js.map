{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sumee/OneDrive/Desktop/content-generation/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error(\"Missing Supabase env variables\");\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,uMAAY,EAAC,aAAa"}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sumee/OneDrive/Desktop/content-generation/app/workspace/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ntype ContentIdea = {\r\n  title?: string;\r\n  hook?: string;\r\n  script?: string;\r\n  caption?: string;\r\n  hashtags?: string[];\r\n  cta?: string;\r\n  explanation?: string;\r\n};\r\n\r\ntype ChatMessage = {\r\n  sender: \"user\" | \"ai\";\r\n  text: string;\r\n  ideas?: ContentIdea[];\r\n};\r\n\r\nexport default function Workspace() {\r\n  const router = useRouter();\r\n  const [messages, setMessages] = useState<ChatMessage[]>([\r\n    { sender: \"ai\", text: \"Hey! ðŸ‘‹ What content do you want to create today?\" },\r\n  ]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [checkingAuth, setCheckingAuth] = useState(true);\r\n  const scrollRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // âœ… AUTH CHECK\r\n  useEffect(() => {\r\n    const checkAuth = async () => {\r\n      try {\r\n        const { data } = await supabase.auth.getUser();\r\n\r\n        if (!data?.user) {\r\n          router.replace(\"/login\");\r\n          return;\r\n        }\r\n\r\n        setCheckingAuth(false);\r\n      } catch (err) {\r\n        console.error(\"Auth check error:\", err);\r\n        router.replace(\"/login\");\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [router]);\r\n\r\n  // âœ… AUTO SCROLL\r\n  useEffect(() => {\r\n    const el = scrollRef.current;\r\n    if (el) el.scrollTop = el.scrollHeight;\r\n  }, [messages]);\r\n\r\n  // âœ… LOGOUT\r\n  const handleLogout = async () => {\r\n    try {\r\n      await supabase.auth.signOut();\r\n    } catch (err) {\r\n      console.error(\"Logout error:\", err);\r\n    } finally {\r\n      router.replace(\"/login\");\r\n    }\r\n  };\r\n\r\n  const sendMessage = async () => {\r\n    if (!input.trim()) return;\r\n    const text = input.trim();\r\n    setInput(\"\");\r\n\r\n    setMessages((prev) => [...prev, { sender: \"user\", text }]);\r\n\r\n    const payloadMessages = [\r\n      ...messages.map((m) => ({\r\n        role: m.sender === \"user\" ? \"user\" : \"assistant\",\r\n        content: m.text,\r\n      })),\r\n      { role: \"user\", content: text },\r\n    ];\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/chat\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ messages: payloadMessages }),\r\n      });\r\n\r\n      const json = await res.json();\r\n      const reply = json.reply;\r\n\r\n      let aiText = \"\";\r\n      let ideaArray: ContentIdea[] | undefined;\r\n\r\n      if (reply?.content) {\r\n        try {\r\n          const parsed = JSON.parse(reply.content);\r\n          if (Array.isArray(parsed)) {\r\n            ideaArray = parsed;\r\n            aiText = `Generated ${parsed.length} content ideas.`;\r\n          } else {\r\n            aiText = reply.content;\r\n          }\r\n        } catch {\r\n          aiText = reply.content;\r\n        }\r\n      } else {\r\n        aiText = \"I'm here! How can I help?\";\r\n      }\r\n\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        { sender: \"ai\", text: aiText, ideas: ideaArray },\r\n      ]);\r\n    } catch (err) {\r\n      console.error(\"Chat error:\", err);\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        { sender: \"ai\", text: \"Something went wrong â€” try again.\" },\r\n      ]);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const approve = (idea: ContentIdea) => {\r\n    const raw = localStorage.getItem(\"cg_library_v1\");\r\n    const prev: ContentIdea[] = raw ? JSON.parse(raw) : [];\r\n    const updated = [idea, ...prev];\r\n    localStorage.setItem(\"cg_library_v1\", JSON.stringify(updated));\r\n\r\n    setMessages((prev) => [\r\n      ...prev,\r\n      { sender: \"ai\", text: `Saved \"${idea.title ?? \"Untitled\"}\" to library.` },\r\n    ]);\r\n  };\r\n\r\n  const reject = (idea: ContentIdea) => {\r\n    setMessages((prev) => [\r\n      ...prev,\r\n      { sender: \"ai\", text: `Skipped \"${idea.title ?? \"Untitled\"}\".` },\r\n    ]);\r\n  };\r\n\r\n  const IdeaTabs = ({ ideas }: { ideas: ContentIdea[] }) => {\r\n    const [open, setOpen] = useState<number | null>(null);\r\n\r\n    return (\r\n      <div\r\n        style={{\r\n          marginTop: 12,\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n          gap: 12,\r\n        }}\r\n      >\r\n        {ideas.map((idea, idx) => {\r\n          const expanded = open === idx;\r\n          return (\r\n            <div\r\n              key={idx}\r\n              style={{\r\n                padding: 14,\r\n                borderRadius: 8,\r\n                background: \"#fff\",\r\n                border: \"1px solid #ddd\",\r\n                cursor: \"pointer\",\r\n              }}\r\n              onClick={() => setOpen(expanded ? null : idx)}\r\n            >\r\n              <strong>{idea.title ?? `Idea ${idx + 1}`}</strong>\r\n\r\n              {expanded && (\r\n                <div style={{ marginTop: 10 }}>\r\n                  {idea.hook && (\r\n                    <p>\r\n                      <b>Hook:</b> {idea.hook}\r\n                    </p>\r\n                  )}\r\n                  {idea.caption && (\r\n                    <p>\r\n                      <b>Caption:</b> {idea.caption}\r\n                    </p>\r\n                  )}\r\n                  {idea.cta && (\r\n                    <p>\r\n                      <b>CTA:</b> {idea.cta}\r\n                    </p>\r\n                  )}\r\n\r\n                  <div style={{ display: \"flex\", gap: 10, marginTop: 8 }}>\r\n                    <button onClick={() => approve(idea)}>Approve</button>\r\n                    <button onClick={() => reject(idea)}>Reject</button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (checkingAuth) {\r\n    return <div style={{ padding: 40 }}>Checking authentication...</div>;\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding: 4 }}>\r\n      {/* Top bar */}\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"space-between\",\r\n          alignItems: \"center\",\r\n          marginBottom: 12,\r\n        }}\r\n      >\r\n        <h2 style={{ margin: 0 }}>Content Workspace</h2>\r\n        <button onClick={handleLogout}>Logout</button>\r\n      </div>\r\n\r\n      {/* Messages */}\r\n      <div\r\n        ref={scrollRef}\r\n        style={{\r\n          height: \"70vh\",\r\n          overflow: \"auto\",\r\n          border: \"1px solid #ddd\",\r\n          padding: 12,\r\n          background: \"white\",\r\n        }}\r\n      >\r\n        {messages.map((m, i) => (\r\n          <div key={i} style={{ marginBottom: 10 }}>\r\n            <div>\r\n              <b>{m.sender === \"user\" ? \"You:\" : \"AI:\"}</b> {m.text}\r\n            </div>\r\n            {m.sender === \"ai\" && m.ideas && <IdeaTabs ideas={m.ideas} />}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Input row */}\r\n      <div style={{ display: \"flex\", gap: 10, marginTop: 10 }}>\r\n        <input\r\n          value={input}\r\n          onChange={(e) => setInput(e.target.value)}\r\n          style={{ flex: 1, padding: 8 }}\r\n          placeholder=\"Type your content idea...\"\r\n        />\r\n        <button onClick={sendMessage} disabled={loading}>\r\n          {loading ? \"...\" : \"Send\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}